---
description: Privilege Escalation Windows - Cheatsheet - Stratégie AlwaysInstallElevated
---

# Strategie AlwaysInstallElevated



1. <mark style="color:yellow;">Identification de la Stratégie :</mark>
   * Utilisez l'éditeur de stratégie de groupe (gpedit.msc) pour vérifier si la stratégie `AlwaysInstallElevated` est activée.
2. <mark style="color:yellow;">Vérification de l'Autorisation d'Installation :</mark>
   * Recherchez les programmes MSI (Microsoft Installer) pour lesquels l'installation est autorisée en tant qu'administrateur.
3. <mark style="color:yellow;">Exploitation de la Stratégie</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">`AlwaysInstallElevated`</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">:</mark>
   * Créez un fichier MSI avec un programme malveillant et utilisez-le pour exploiter la stratégie AlwaysInstallElevated.
4. <mark style="color:yellow;">Utilisation de l'Utilitaire MSIEXEC :</mark>
   * Utilisez l'outil `msiexec` avec des privilèges élevés pour exécuter un fichier MSI malveillant.
5. <mark style="color:yellow;">Abus des Autorisations de Fichiers :</mark>
   * Identifiez les fichiers MSI avec des autorisations de fichiers faibles pour les modifier et les utiliser pour l'élévation de privilèges.
6. <mark style="color:yellow;">Modification de la Stratégie de Groupe :</mark>
   * Modifiez la stratégie `AlwaysInstallElevated` pour inclure le fichier MSI malveillant et exécuter un programme avec des privilèges élevés.
7. <mark style="color:yellow;">Recherche de Répertoires Partagés :</mark>
   * Recherchez des répertoires partagés avec l'autorisation `Écriture` pour placer le fichier MSI malveillant.
8. <mark style="color:yellow;">Utilisation d'outils MSI pour l'Élévation de Privilèges :</mark>
   * Utilisez des outils tels que `WiX Toolset` pour créer des fichiers MSI malveillants pour l'élévation de privilèges.
9. <mark style="color:yellow;">Analyse des Événements de Sécurité :</mark>
   * Surveillez les événements de sécurité pour détecter toute utilisation abusive de la stratégie `AlwaysInstallElevated`.
10. <mark style="color:yellow;">Vérification de la Version du Système d'Exploitation :</mark>
    * Assurez-vous que la stratégie `AlwaysInstallElevated` est applicable à la version spécifique du système d'exploitation.
11. <mark style="color:yellow;">Utilisation d'outils d'analyse :</mark>
    * Utilisez des outils d'analyse comme `Procmon` de Sysinternals pour surveiller l'accès aux fichiers et détecter les modifications de la stratégie.
